<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regex Tester</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Fira+Code:wght@400&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
        }
        .code-font {
            font-family: 'Fira Code', monospace;
        }
        .highlight {
            background-color: #dbeafe; /* blue-100 */
            border-bottom: 2px solid #60a5fa; /* blue-400 */
            border-radius: 2px;
            font-weight: 500;
        }
        .regex-error {
            background-color: #fee2e2; /* red-100 */
            color: #ef4444; /* red-500 */
        }
        .loader {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #3b82f6;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-800 antialiased">
    <div class="flex flex-col min-h-screen">
        <!-- Header -->
        <header class="bg-white border-b border-gray-200">
            <div class="container mx-auto px-6 py-4">
                <h1 class="text-3xl font-bold text-gray-700">Regex Tester</h1>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow container mx-auto px-6 py-8 space-y-6">

            <!-- Row 1: Input String -->
            <div class="bg-white p-5 rounded-lg border border-gray-200 shadow-sm">
                <label for="input-string" class="text-lg font-semibold text-gray-600 block mb-3">Test String</label>
                <textarea 
                    id="input-string"
                    class="w-full h-40 p-3 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition code-font text-sm"
                    placeholder="Enter the string to test your regex against..."
                ></textarea>
            </div>

            <!-- Row 2: Regex Input -->
            <div class="bg-white p-5 rounded-lg border border-gray-200 shadow-sm">
                <label for="regex-input" class="text-lg font-semibold text-gray-600 block mb-3">Regular Expression</label>
                <div class="flex items-center bg-gray-50 border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-transparent transition">
                    <span class="px-3 text-gray-500 text-lg">/</span>
                    <input 
                        type="text"
                        id="regex-input"
                        class="w-full p-3 bg-transparent focus:outline-none code-font text-sm"
                        placeholder="your-regex-pattern"
                    />
                    <span class="px-3 text-gray-500 text-lg">/</span>
                    <div id="regex-flags" class="p-3 space-x-4 text-sm">
                        <label><input type="checkbox" id="flag-g" class="rounded" checked> g</label>
                        <label><input type="checkbox" id="flag-i" class="rounded"> i</label>
                        <label><input type="checkbox" id="flag-m" class="rounded"> m</label>
                    </div>
                </div>
            </div>

            <!-- Row 3: Matches Table -->
            <div id="matches-container" class="bg-white p-5 rounded-lg border border-gray-200 shadow-sm overflow-x-auto">
                <h2 class="text-lg font-semibold text-gray-600 mb-3">Matches</h2>
                <div class="overflow-hidden border border-gray-200 rounded-lg">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16">#</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Full Match</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Groups</th>
                            </tr>
                        </thead>
                        <tbody id="match-results-body" class="bg-white divide-y divide-gray-200">
                            <!-- Match rows will be injected here by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="bg-gradient-to-r from-green-600 via-teal-600 to-green-500 text-white text-center py-2 text-sm mt-8">
            <p>&#x1F512; All data is processed locally in your browser and is never sent to the internet.</p>
        </footer>
    </div>

    <script>
        const inputStringEl = document.getElementById('input-string');
        const regexInputEl = document.getElementById('regex-input');
        const matchResultsBody = document.getElementById('match-results-body');
        const regexFlagsEl = document.getElementById('regex-flags');

        const initialString = "Contact us at support@example.com, sales@example.org, or info@example.net for assistance. Our office number is (123) 456-7890.";
        const initialRegex = "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}";
        
        inputStringEl.value = initialString;
        regexInputEl.value = initialRegex;

        const performMatch = () => {
            const pattern = regexInputEl.value;
            const text = inputStringEl.value;
            
            // Clear previous state
            matchResultsBody.innerHTML = '';
            regexInputEl.classList.remove('regex-error');

            if (!pattern.trim()) {
                matchResultsBody.innerHTML = `<tr><td colspan="3" class="text-center px-6 py-4 text-gray-500">Enter a pattern to see matches.</td></tr>`;
                return;
            }
            
            let flags = '';
            regexFlagsEl.querySelectorAll('input[type="checkbox"]').forEach(flagEl => {
                if (flagEl.checked) flags += flagEl.id.replace('flag-', '');
            });

            try {
                // The 'g' flag is necessary for matchAll to work as expected
                const isGlobal = flags.includes('g');
                const regex = new RegExp(pattern, flags);
                
                let matches = [];
                if (isGlobal) {
                    matches = [...text.matchAll(regex)];
                } else {
                    const match = text.match(regex);
                    if (match) {
                        // The structure of a non-global match is slightly different
                        // We push it into an array to handle it the same way
                        matches.push(match);
                    }
                }

                if (matches.length > 0) {
                    matches.forEach((match, index) => {
                        const fullMatch = match[0] || '';
                        // Sanitize to prevent HTML injection from the input string
                        const sanitizedMatch = fullMatch.replace(/</g, "&lt;").replace(/>/g, "&gt;");

                        const groups = match.slice(1).map((g, i) => {
                           const value = g === undefined ? '<em>undefined</em>' : `"${String(g).replace(/</g, "&lt;").replace(/>/g, "&gt;")}"`;
                           return `<strong class="text-gray-600">${i + 1}:</strong> ${value}`;
                        }).join('<br>');
                        
                        const row = document.createElement('tr');
                        row.className = 'hover:bg-gray-50';
                        row.innerHTML = `
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${index + 1}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700 code-font">${sanitizedMatch}</td>
                            <td class="px-6 py-4 text-sm text-gray-700 code-font">${groups || '<em>none</em>'}</td>
                        `;
                        matchResultsBody.appendChild(row);
                    });
                } else {
                     matchResultsBody.innerHTML = `<tr><td colspan="3" class="text-center px-6 py-4 text-gray-500">No matches found.</td></tr>`;
                }
            } catch (e) {
                regexInputEl.classList.add('regex-error');
                matchResultsBody.innerHTML = `<tr><td colspan="3" class="text-center px-6 py-4 text-red-600">Invalid regular expression.</td></tr>`;
            }
        };


        inputStringEl.addEventListener('input', performMatch);
        regexInputEl.addEventListener('input', performMatch);
        regexFlagsEl.addEventListener('change', performMatch);
        
        // Initial match on load
        window.onload = performMatch;
    </script>
</body>
</html>

